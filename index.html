<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Video Viewing Website</title>
<style>
  :root {
    --bg:#f9fafb;
    --text:#111827;
    --card-bg:#ffffff;
    --primary:#2563eb;
    --primary-hover:#1e40af;
    --modal-bg:rgba(0,0,0,0.85);
    --radius:12px;
  }
  body.dark {
    --bg:#0f172a;
    --text:#e2e8f0;
    --card-bg:#1e293b;
    --primary:#3b82f6;
    --primary-hover:#2563eb;
    --modal-bg:rgba(0,0,0,0.9);
  }
  body {
    margin:0;
    font-family:'Segoe UI', Roboto, sans-serif;
    background:var(--bg);
    color:var(--text);
    transition:all 0.3s ease;
  }

  /* Header */
  header {
    position:sticky; top:0; z-index:50;
    display:flex; align-items:center; gap:10px;
    padding:12px 16px;
    background:var(--card-bg);
    box-shadow:0 2px 6px rgba(0,0,0,0.1);
  }
  #searchBar {
    flex:1;
    padding:10px 14px;
    border:1px solid #d1d5db;
    border-radius:var(--radius);
    font-size:15px;
    background:var(--bg);
    color:var(--text);
  }
  .header-actions { display:flex; gap:10px; align-items:center; }
  .icon-btn {
    background:var(--primary);
    border:none;
    border-radius:var(--radius);
    cursor:pointer;
    padding:8px 10px;
    display:flex; align-items:center; justify-content:center;
    transition:all 0.25s;
  }
  .icon-btn:hover { background:var(--primary-hover); }
  .icon-btn svg { width:20px; height:20px; stroke:#fff; }

  /* Theme toggle */
  .theme-toggle {
    width:48px; height:24px;
    background:#d1d5db;
    border-radius:999px;
    position:relative;
    cursor:pointer;
    transition:all 0.3s;
  }
  .theme-toggle::after {
    content:"";
    width:20px; height:20px;
    background:#fff;
    border-radius:50%;
    position:absolute; top:2px; left:2px;
    transition:all 0.3s;
  }
  body.dark .theme-toggle { background:#3b82f6; }
  body.dark .theme-toggle::after { transform:translateX(24px); }

  /* Filter buttons */
  .filter-buttons {
    display:flex; flex-wrap:wrap;
    gap:10px; padding:12px 16px;
    justify-content:center;
  }
  .filter-buttons button {
    display:flex; align-items:center; gap:6px;
    padding:8px 14px;
    border:none; border-radius:var(--radius);
    background:var(--primary); color:#fff;
    font-size:14px; cursor:pointer;
    transition:all 0.25s;
  }
  .filter-buttons button:hover { background:var(--primary-hover); }
  .filter-buttons button svg { width:16px; height:16px; stroke:#fff; }

  /* Video grid */
  .video-grid {
    display:grid; gap:16px; padding:16px;
    grid-template-columns:1fr;
  }
  @media(min-width:600px){
    .video-grid {
      grid-template-columns:repeat(auto-fill,minmax(250px,1fr));
      max-width:1400px; margin:auto;
    }
  }
  @media(min-width:1200px){
    .video-grid { grid-template-columns:repeat(4,1fr); }
  }
  .video-card {
    background:var(--card-bg);
    border-radius:var(--radius);
    overflow:hidden;
    box-shadow:0 4px 8px rgba(0,0,0,0.08);
    cursor:pointer;
    transition:transform 0.2s, box-shadow 0.2s;
  }
  .video-card:hover { transform:translateY(-4px); box-shadow:0 6px 12px rgba(0,0,0,0.15); }
  .video-card img { width:100%; aspect-ratio:3/2; object-fit:cover; }
  .video-card b { display:block; padding:10px; font-size:15px; text-align:center; }

  /* Pagination */
  .pagination {
    display:flex; justify-content:center; flex-wrap:wrap;
    gap:6px; padding:16px;
  }
  .pagination button {
    padding:6px 12px;
    border:1px solid #cbd5e1;
    background:var(--card-bg);
    border-radius:6px;
    cursor:pointer;
    color:var(--text);
    font-size:14px;
    transition:all 0.25s;
  }
  .pagination button.active {
    background:var(--primary);
    color:#fff;
    border:none;
  }

  /* Modal */
  .modal {
    display:none;
    position:fixed; top:0; left:0;
    width:100%; height:100%;
    z-index:1000;
    background:var(--modal-bg);
    justify-content:center; align-items:flex-start;
    overflow-y:auto; padding:20px;
  }
  .modal-content {
    background:var(--card-bg);
    width:95%; max-width:900px;
    margin:40px auto;
    border-radius:var(--radius);
    overflow:hidden;
    min-height:70vh;
    color:var(--text);
    position:relative;
    box-shadow:0 6px 18px rgba(0,0,0,0.25);
    animation:fadeIn 0.3s ease;
  }
  .close {
    position:fixed; top:14px; right:20px;
    font-size:34px; color:#fff;
    cursor:pointer; z-index:2000;
  }
  .player { width:100%; aspect-ratio:16/9; background:#000; display:block; }
  .video-title { font-size:18px; font-weight:600; margin:10px 0 0 0; padding:0 16px; }
  .details { padding:16px; line-height:1.6; }
  .details p span {
    display:inline-block; margin:3px 4px;
    padding:5px 10px;
    background:#e5e7eb;
    border-radius:8px;
    font-size:13px;
    cursor:pointer;
  }
  body.dark .details p span { background:#334155; }
  .gallery img { width:100%; margin:12px 0; border-radius:8px; }

  /* Filter modal */
  .filter-modal-content {
    background:var(--card-bg);
    width:95%; max-width:600px;
    margin:40px auto;
    border-radius:var(--radius);
    padding:18px;
    min-height:60vh;
    color:var(--text);
  }
  .filter-search { margin-bottom:12px; }
  .filter-search input {
    width:100%;
    padding:10px;
    border:1px solid #d1d5db;
    border-radius:var(--radius);
    background:var(--bg);
    color:var(--text);
  }
  .grid-3 { display:grid; grid-template-columns:repeat(3,1fr); gap:14px; }
  .grid-3 div { text-align:center; cursor:pointer; transition:transform 0.2s; }
  .grid-3 div:hover { transform:scale(1.05); }
  .grid-3 img { width:100%; aspect-ratio:2/3; object-fit:cover; border-radius:8px; }
  .grid-3 .name { display:block; font-weight:600; margin-top:6px; font-size:14px; }
  .grid-3 .count { display:block; font-size:13px; color:#6b7280; }
  body.dark .grid-3 .count { color:#94a3b8; }

  @keyframes fadeIn {
    from {opacity:0; transform:translateY(10px);}
    to {opacity:1; transform:translateY(0);}
  }
</style>
</head>
<body>

<header>
  <button class="icon-btn" id="homeBtn" title="Home">
    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path d="M3 9.5l9-7 9 7V20a2 2 0 0 1-2 2h-4v-7H9v7H5a2 2 0 0 1-2-2V9.5z"/></svg>
  </button>
  <input type="text" id="searchBar" placeholder="Search videos...">
  <div class="header-actions">
    <button class="icon-btn" id="shuffleBtn" title="Shuffle Videos">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path d="M16 3h5v5M4 20l5-5m11-2h-3.5a2.5 2.5 0 0 1-2-4l5-5"/></svg>
    </button>
    <div class="theme-toggle" id="themeToggle"></div>
  </div>
</header>

<div class="filter-buttons">
  <button onclick="openFilter('actress')">
    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path d="M12 12c2.7 0 5-2.3 5-5s-2.3-5-5-5-5 2.3-5 5 2.3 5 5 5zm0 2c-3.3 0-10 1.7-10 5v3h20v-3c0-3.3-6.7-5-10-5z"/></svg>
    Actress
  </button>
  <button onclick="openFilter('studio')">
    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path d="M4 4h16v16H4z"/></svg>
    Studio
  </button>
  <button onclick="openFilter('label')">
    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path d="M3 7l9-4 9 4-9 4-9-4z"/><path d="M3 17l9-4 9 4"/><path d="M3 12l9-4 9 4"/></svg>
    Label
  </button>
  <button onclick="openFilter('series')">
    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path d="M3 3h7v7H3V3zm0 11h7v7H3v-7zm11-11h7v7h-7V3zm0 11h7v7h-7v-7z"/></svg>
    Series
  </button>
  <button onclick="openFilter('tags')">
    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path d="M7 7h10v10H7z"/></svg>
    Tags
  </button>
  <button class="icon-btn" id="randomBtn" title="Random Video">
    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path d="M5 3l14 9-14 9V3z"/></svg>
  </button>
</div>

<div class="video-grid" id="videoGrid"></div>
<div class="pagination" id="pagination"></div>

<!-- Video Modal -->
<div class="modal" id="videoModal">
  <span class="close" onclick="closeModal('videoModal')">&times;</span>
  <div class="modal-content">
    <iframe id="videoPlayer" class="player" src="" frameborder="0" allowfullscreen loading="lazy"></iframe>
    <div id="videoTitle" class="video-title"></div>
    <div class="details" id="videoDetails"></div>
    <div class="gallery" id="videoGallery"></div>
  </div>
</div>

<!-- Filter Modal -->
<div class="modal" id="filterModal">
  <span class="close" onclick="closeModal('filterModal')">&times;</span>
  <div class="filter-modal-content" id="filterContent">
    <h3 id="filterTitle"></h3>
    <div class="filter-search"><input type="text" id="filterSearch" placeholder="Search..."></div>
    <div id="filterBody"></div>
  </div>
</div>

<script src="filters.js"></script>
<script src="videos.js"></script>
<script>
// same JS logic from before (unchanged)
function toArray(val){ if(!val) return []; if(Array.isArray(val)) return val.map(v=>v.trim()); return val.split(",").map(v=>v.trim()).filter(Boolean); }
function shuffleArray(arr){ return arr.sort(()=>Math.random()-0.5); }

const perPage=12; let currentPage=1; let activeFilters={}; let filtered=shuffleArray([...videos]);

function applyAllFilters(){ filtered=videos.filter(v=>{ return Object.entries(activeFilters).every(([k,vals])=>!vals.length||vals.some(val=>toArray(v[k]).includes(val))); }); filtered=shuffleArray(filtered); currentPage=1; renderVideos(); }
function renderVideos(){ const grid=document.getElementById("videoGrid"); grid.innerHTML=""; const start=(currentPage-1)*perPage; const pageItems=filtered.slice(start,start+perPage); pageItems.forEach(v=>{ const card=document.createElement("div"); card.className="video-card"; card.innerHTML=`<img src="${v.thumbnail}" loading="lazy"><b>${v.title}</b>`; card.onclick=()=>openVideo(v); grid.appendChild(card); }); renderPagination(); window.scrollTo({top:0,behavior:"smooth"}); }
function renderPagination(){ const totalPages=Math.ceil(filtered.length/perPage); const pag=document.getElementById("pagination"); pag.innerHTML=""; for(let i=1;i<=totalPages;i++){ const btn=document.createElement("button"); btn.textContent=i; if(i===currentPage) btn.classList.add("active"); btn.onclick=()=>{currentPage=i; renderVideos();}; pag.appendChild(btn);} }

document.getElementById("searchBar").addEventListener("input",e=>{ const q=e.target.value.toLowerCase(); activeFilters={}; filtered=shuffleArray(videos.filter(v=> v.title.toLowerCase().includes(q) || v.code.toLowerCase().includes(q) || toArray(v.actress).some(a=>a.toLowerCase().includes(q)) || toArray(v.studio).some(s=>s.toLowerCase().includes(q)) || toArray(v.label).some(l=>l.toLowerCase().includes(q)) || toArray(v.series).some(s=>s.toLowerCase().includes(q)) || toArray(v.tags).some(t=>t.toLowerCase().includes(q)) )); currentPage=1; renderVideos(); });

function openVideo(v){ document.getElementById("videoTitle").textContent=v.title; document.getElementById("videoPlayer").src=v.videoUrl; const details=`<p><b>Code:</b> <span onclick="setFilter('code','${v.code}')">${v.code}</span></p><p><b>Actress:</b> ${toArray(v.actress).map(a=>`<span onclick="setFilter('actress','${a}')">${a}</span>`).join(" ")}</p><p><b>Studio:</b> ${toArray(v.studio).map(s=>`<span onclick="setFilter('studio','${s}')">${s}</span>`).join(" ")}</p><p><b>Label:</b> ${toArray(v.label).map(l=>`<span onclick="setFilter('label','${l}')">${l}</span>`).join(" ")}</p><p><b>Series:</b> ${toArray(v.series).map(s=>`<span onclick="setFilter('series','${s}')">${s}</span>`).join(" ")}</p><p><b>Tags:</b> ${toArray(v.tags).map(t=>`<span onclick="setFilter('tags','${t}')">${t}</span>`).join(" ")}</p><p>${v.description}</p>`; document.getElementById("videoDetails").innerHTML=details; const gallery=document.getElementById("videoGallery"); gallery.innerHTML=""; v.gallery.forEach(img=>{ const el=document.createElement("img"); el.src=img; el.loading="lazy"; gallery.appendChild(el); }); document.getElementById("videoModal").style.display="flex"; }
function closeModal(id){ document.getElementById(id).style.display="none"; if(id==="videoModal") document.getElementById("videoPlayer").src=""; }

function openFilter(type){ const modal=document.getElementById("filterModal"); const body=document.getElementById("filterBody"); const title=document.getElementById("filterTitle"); body.innerHTML=""; title.textContent="Choose "+type; let items; if(type==="tags"){ items=shuffleArray([...new Set(videos.flatMap(v=>toArray(v.tags)))]);} else { items=shuffleArray([...new Set(videos.flatMap(v=>toArray(v[type])))]);} const container=document.createElement("div"); container.className="grid-3"; items.forEach(it=>{ const count=videos.filter(v=>toArray(v[type]).includes(it)).length; const imgLink=(type==="tags"?filters.tags?.[it]:filters[type]?.[it])||"https://via.placeholder.com/200x300.png?text="+encodeURIComponent(it); const div=document.createElement("div"); div.innerHTML=`<img src="${imgLink}" loading="lazy"><span class="name">${it}</span><span class="count">${count} videos</span>`; div.onclick=()=>setFilter(type,it); container.appendChild(div); }); body.appendChild(container); const searchInput=document.getElementById("filterSearch"); searchInput.value=""; searchInput.oninput=()=>{ const q=searchInput.value.toLowerCase(); [...container.children].forEach(child=>{ const name=child.querySelector(".name").textContent.toLowerCase(); child.style.display=name.includes(q)?"block":"none"; }); }; modal.style.display="flex"; }
function setFilter(type,val){ if(!activeFilters[type]) activeFilters[type]=[]; if(!activeFilters[type].includes(val)) activeFilters[type].push(val); applyAllFilters(); closeModal("filterModal"); closeModal("videoModal"); }

document.getElementById("shuffleBtn").addEventListener("click",()=>{ filtered=shuffleArray([...filtered]); currentPage=1; renderVideos(); });
document.getElementById("randomBtn").addEventListener("click",()=>{ const all=filtered.length?filtered:videos; const v=all[Math.floor(Math.random()*all.length)]; openVideo(v); });
document.getElementById("homeBtn").addEventListener("click",()=>{ activeFilters={}; filtered=shuffleArray([...videos]); currentPage=1; renderVideos(); });

const themeToggle=document.getElementById("themeToggle"); themeToggle.addEventListener("click",()=>{ document.body.classList.toggle("dark"); localStorage.setItem("theme",document.body.classList.contains("dark")?"dark":"light"); }); if(localStorage.getItem("theme")==="dark"){ document.body.classList.add("dark"); }

renderVideos();
</script>
</body>
</html>
